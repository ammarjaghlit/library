{
	"info": {
		"_postman_id": "17985585-a37b-456a-ac79-8204cd0acc85",
		"name": "Ephemeral Authentication Labs",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "Agility2020",
			"item": [
				{
					"name": "lab Setup",
					"item": [
						{
							"name": "bigip1-Create-Test AS3 is running",
							"event": [
								{
									"listen": "test",
									"script": {
										"id": "cab2e060-40dd-4d23-a711-7aaa25e64135",
										"exec": [
											"if (responseCode.code === 200) {",
											"pm.collectionVariables.set('PRIOR_RESPONSE', 'OK' );",
											"",
											"}",
											"",
											"",
											"pm.test(\"AS3 is Running\", function () {",
											"    pm.response.to.have.status(200);",
											"});",
											"",
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "prerequest",
									"script": {
										"id": "fbb4c539-0f37-44a0-aa54-a0eda1e8661d",
										"exec": [
											"var STAGE = pm.environment.get(\"stage\");",
											"",
											"if (STAGE === \"setup\") {",
											"pm.collectionVariables.set(\"DNS_RESOLVER_NAME\", \"internal-dns-resolver\");",
											"pm.collectionVariables.set(\"SERVER_SSL_NAME\", \"apiadmin-serverssl\");",
											"} else if(STAGE === 'delete') {",
											"postman.setNextRequest(\"bigip5-Delete-Test AS3 is running\");",
											"} else",
											"postman.setNextRequest(null);"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin",
											"type": "string"
										}
									]
								},
								"method": "GET",
								"header": [],
								"url": {
									"raw": "https://10.1.1.4/mgmt/shared/appsvcs/info",
									"protocol": "https",
									"host": [
										"10",
										"1",
										"1",
										"4"
									],
									"path": [
										"mgmt",
										"shared",
										"appsvcs",
										"info"
									]
								}
							},
							"response": []
						},
						{
							"name": "bigip1-Create-DNS Resolver",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "d5b17bd7-df32-4a4f-bc8a-d33a814d4e09",
										"exec": [
											"var PRIOR_RESPONSE = pm.collectionVariables.get(\"PRIOR_RESPONSE\");",
											"",
											"if (PRIOR_RESPONSE === 'OK') {",
											"",
											"}"
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"id": "89627c55-33b6-46a6-9aa9-4e52d9c627bc",
										"exec": [
											"if (responseCode.code === 200) {",
											"pm.collectionVariables.set('PRIOR_RESPONSE', 'OK' );",
											"pm.test(\"DNS Resolver Created\", function () {",
											"    pm.response.to.have.status(200);",
											"});",
											"} else ",
											"pm.test(\"DNS Resolver Exists\", function () {",
											"    pm.response.to.have.status(409);",
											"});",
											"",
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"type": "text",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\r\n\"name\":\"{{DNS_RESOLVER_NAME}}\", \r\n \"forwardZones\": [\r\n                {\r\n                    \"name\": \".\",\r\n                    \"nameservers\": [\r\n                        {\r\n                            \"name\": \"10.1.20.7:53\"\r\n                        }\r\n                    ]\r\n                }\r\n            ]\r\n}"
								},
								"url": {
									"raw": "https://10.1.1.4/mgmt/tm/net/dns-resolver",
									"protocol": "https",
									"host": [
										"10",
										"1",
										"1",
										"4"
									],
									"path": [
										"mgmt",
										"tm",
										"net",
										"dns-resolver"
									]
								}
							},
							"response": []
						},
						{
							"name": "bigip1-Create-APIadmin Serverside SSL Profile",
							"event": [
								{
									"listen": "test",
									"script": {
										"id": "ad5fcc7c-7226-445f-8a9a-bb07533e11ff",
										"exec": [
											"if (responseCode.code === 200) {",
											"pm.collectionVariables.set('PRIOR_RESPONSE', 'OK' );",
											"pm.test(\"Server-Side SSL Profile Created\", function () {",
											"    pm.response.to.have.status(200);",
											"});",
											"} else ",
											"pm.test(\"Server-Side SSL Profile Exists\", function () {",
											"    pm.response.to.have.status(409);",
											"});",
											"",
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "prerequest",
									"script": {
										"id": "fb5a67b3-81d4-4366-9e31-bf504e5a4924",
										"exec": [
											"",
											"var PRIOR_RESPONSE = pm.collectionVariables.get(\"PRIOR_RESPONSE\");",
											"",
											"if (PRIOR_RESPONSE === 'OK') {",
											"",
											"}"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json",
										"type": "text"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\r\n\"name\": \"{{SERVER_SSL_NAME}}\",\r\n \"cert\": \"/Common/apiadmin.crt\",\r\n \"key\": \"/Common/apiadmin.key\"\r\n}"
								},
								"url": {
									"raw": "https://10.1.1.4/mgmt/tm/ltm/profile/server-ssl/",
									"protocol": "https",
									"host": [
										"10",
										"1",
										"1",
										"4"
									],
									"path": [
										"mgmt",
										"tm",
										"ltm",
										"profile",
										"server-ssl",
										""
									]
								}
							},
							"response": []
						},
						{
							"name": "bigip1-Create-irule",
							"event": [
								{
									"listen": "test",
									"script": {
										"id": "870bc708-663a-4aff-8dc1-cb2a3867588b",
										"exec": [
											"if (responseCode.code === 200) {",
											"pm.collectionVariables.set('PRIOR_RESPONSE', 'OK' );",
											"pm.test(\"iRule Created\", function () {",
											"    pm.response.to.have.status(200);",
											"});",
											"} else ",
											"pm.test(\"iRule Exists\", function () {",
											"    pm.response.to.have.status(409);",
											"});",
											"",
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "prerequest",
									"script": {
										"id": "865a1b4d-d5f3-4c28-90e5-85fc97af6fba",
										"exec": [
											"",
											"var PRIOR_RESPONSE = pm.collectionVariables.get(\"PRIOR_RESPONSE\");",
											"",
											"if (PRIOR_RESPONSE === 'OK') {",
											"",
											"}"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json",
										"type": "text"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\r\n\r\n    \"name\": \"Cert_SSO\",\r\n\r\n    \"apiAnonymous\": \"when SERVERSSL_CLIENTHELLO_SEND {\\n\\nset username [ACCESS::session data get \\\"session.logon.last.username\\\"]\\nset domain [ACCESS::session data get \\\"session.ad.last.actualdomain\\\"]\\n  SSL::c3d extension 1.1.1.1 \\\"Minted Extension=$username@$domain\\\"\\n}\\n\\nwhen ACCESS_PER_REQUEST_AGENT_EVENT {\\n set cert [ACCESS::session data get {session.ssl.cert.whole}]\\n log local0. \\\"My cert: $cert\\\"\\n SSL::c3d cert [X509::pem2der $cert]\\n}\"\r\n}"
								},
								"url": {
									"raw": "https://10.1.1.4/mgmt/tm/ltm/rule/",
									"protocol": "https",
									"host": [
										"10",
										"1",
										"1",
										"4"
									],
									"path": [
										"mgmt",
										"tm",
										"ltm",
										"rule",
										""
									]
								}
							},
							"response": []
						},
						{
							"name": "bigip1-Create-LDAP Server Pool",
							"event": [
								{
									"listen": "test",
									"script": {
										"id": "176ebcb6-b5f5-4403-8b34-139622d25be9",
										"exec": [
											"if (responseCode.code === 200) {",
											"pm.collectionVariables.set('PRIOR_RESPONSE', 'OK' );",
											"pm.test(\"Pool Created\", function () {",
											"    pm.response.to.have.status(200);",
											"});",
											"} else ",
											"pm.test(\"Pool Exists\", function () {",
											"    pm.response.to.have.status(409);",
											"});",
											"",
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"type": "text",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "\n{\n\t\"name\":\"ldap-pool\",\n\t\"members\":[\n\t\t{\n\t\t\"name\":\"10.1.20.7:0\",\n\t\t\"address\":\"10.1.20.7\",\n\t\t\"monitor\": \"/Common/gateway_icmp\"\n\t\t\t\n\t\t}\n\t\t]\n}"
								},
								"url": {
									"raw": "https://10.1.1.4/mgmt/tm/ltm/pool/",
									"protocol": "https",
									"host": [
										"10",
										"1",
										"1",
										"4"
									],
									"path": [
										"mgmt",
										"tm",
										"ltm",
										"pool",
										""
									]
								}
							},
							"response": []
						},
						{
							"name": "bigip1-Create-APM AAA LDAP",
							"event": [
								{
									"listen": "test",
									"script": {
										"id": "ede1c014-ad73-4afc-8ea3-ae39b9efddbc",
										"exec": [
											"if (responseCode.code === 200) {",
											"pm.collectionVariables.set('PRIOR_RESPONSE', 'OK' );",
											"pm.test(\"APM AAA LDAP Object Created\", function () {",
											"    pm.response.to.have.status(200);",
											"});",
											"} else ",
											"pm.test(\"APM AAA LDAP Object Exists\", function () {",
											"    pm.response.to.have.status(409);",
											"});",
											"",
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "prerequest",
									"script": {
										"id": "0b06ce71-14b0-4df8-b4eb-ff8b8a89c17f",
										"exec": [
											"",
											"var PRIOR_RESPONSE = pm.collectionVariables.get(\"PRIOR_RESPONSE\");",
											"",
											"if (PRIOR_RESPONSE === 'OK') {",
											"",
											"}"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json",
										"type": "text"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\r\n\r\n    \"name\": \"ldap-servers\",\r\n    \"adminDn\": \"CN=Admin,CN=Users,DC=f5lab,DC=local\",\r\n    \"adminEncryptedPassword\": \"admin\",\r\n    \"isLdaps\": \"false\",\r\n    \"locationSpecific\": \"true\",\r\n    \"pool\": \"/Common/ldap-pool\",\r\n    \"port\": 389,\r\n    \"schemaAttr\": {\r\n        \"groupMember\": \"member\",\r\n        \"groupMemberValue\": \"dn\",\r\n        \"groupMemberof\": \"memberOf\",\r\n        \"groupObjectClass\": \"group\",\r\n        \"userMemberof\": \"memberOf\",\r\n        \"userObjectClass\": \"user\"\r\n    },\r\n    \"timeout\": 15,\r\n    \"usePool\": \"enabled\"\r\n}"
								},
								"url": {
									"raw": "https://10.1.1.4/mgmt/tm/apm/aaa/ldap/",
									"protocol": "https",
									"host": [
										"10",
										"1",
										"1",
										"4"
									],
									"path": [
										"mgmt",
										"tm",
										"apm",
										"aaa",
										"ldap",
										""
									]
								}
							},
							"response": []
						},
						{
							"name": "bigip5-Create-Test AS3 is running",
							"event": [
								{
									"listen": "test",
									"script": {
										"id": "123f7727-307a-44ce-a7a0-28774653d400",
										"exec": [
											"if (responseCode.code === 200) {",
											"pm.collectionVariables.set('PRIOR_RESPONSE', 'OK' );",
											"",
											"}",
											"",
											"",
											"pm.test(\"AS3 is Running\", function () {",
											"    pm.response.to.have.status(200);",
											"});",
											"",
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "prerequest",
									"script": {
										"id": "8ede0469-198b-4b60-8d1e-666f38c26881",
										"exec": [
											"var PRIOR_RESPONSE = pm.collectionVariables.get(\"PRIOR_RESPONSE\");",
											"",
											"if (PRIOR_RESPONSE === 'OK') {",
											"",
											"}"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin",
											"type": "string"
										}
									]
								},
								"method": "GET",
								"header": [],
								"url": {
									"raw": "https://10.1.1.11/mgmt/shared/appsvcs/info",
									"protocol": "https",
									"host": [
										"10",
										"1",
										"1",
										"11"
									],
									"path": [
										"mgmt",
										"shared",
										"appsvcs",
										"info"
									]
								}
							},
							"response": []
						},
						{
							"name": "bigip5-Create-Add bigip1 mtls.acme.com VS to Server",
							"event": [
								{
									"listen": "test",
									"script": {
										"id": "f84ed88b-495f-49f8-a94d-f8017d718e1d",
										"exec": [
											"if (responseCode.code === 200) {",
											"pm.collectionVariables.set('PRIOR_RESPONSE', 'OK' );",
											"pm.test(\"Virtual Server added to Server\", function () {",
											"    pm.response.to.have.status(200);",
											"});",
											"} else ",
											"pm.test(\"Virtual Server Exists\", function () {",
											"    pm.response.to.have.status(409);",
											"});"
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "prerequest",
									"script": {
										"id": "e591e40b-dc52-4a4a-b7d2-a7692f8a27b3",
										"exec": [
											"pm.collectionVariables.set(\"APP_NAME\", \"mtls.acme.com\");",
											"pm.collectionVariables.set(\"PATH_NAME\", \"Application\");",
											"pm.collectionVariables.set(\"PARTITION_NAME\", \"Common\");",
											"",
											"",
											"var PRIOR_RESPONSE = pm.collectionVariables.get(\"PRIOR_RESPONSE\");",
											"",
											"if (PRIOR_RESPONSE === 'OK') {",
											"",
											"}"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json",
										"type": "text"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\r\n\"name\": \"/{{PARTITION_NAME}}/{{PATH_NAME}}/{{APP_NAME}}\",\r\n\"destination\": \"10.1.10.105:443\"\r\n}"
								},
								"url": {
									"raw": "https://10.1.1.11/mgmt/tm/gtm/server/~Common~bigip1.f5lab.local/virtual-servers/",
									"protocol": "https",
									"host": [
										"10",
										"1",
										"1",
										"11"
									],
									"path": [
										"mgmt",
										"tm",
										"gtm",
										"server",
										"~Common~bigip1.f5lab.local",
										"virtual-servers",
										""
									]
								}
							},
							"response": []
						},
						{
							"name": "bigip5-Create-WideIP mtls.acme.com using AS3",
							"event": [
								{
									"listen": "test",
									"script": {
										"id": "d3656feb-3ec9-4961-b68a-230734cbe490",
										"exec": [
											"if (responseCode.code === 200) {",
											"pm.collectionVariables.set('PRIOR_RESPONSE', 'OK' );",
											"}",
											"",
											"pm.test(\"Wide IP Created\", function () {",
											"    pm.response.to.have.status(200);",
											"});"
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "prerequest",
									"script": {
										"id": "832e657c-dd71-4493-ac1d-f210af903d9e",
										"exec": [
											"setTimeout(function(){}, 2000);",
											"",
											"var PRIOR_RESPONSE = pm.collectionVariables.get(\"PRIOR_RESPONSE\");",
											"",
											"if (PRIOR_RESPONSE === 'OK') {",
											"",
											"}"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\r\n \"class\": \"ADC\",\r\n    \"schemaVersion\": \"3.6.0\",\r\n    \"id\": \"GSLB_Sample\",\r\n    \"{{APP_NAME}}\": {\r\n        \"class\": \"Tenant\",\r\n        \"Application\": {\r\n            \"class\": \"Application\",\r\n            \"template\": \"generic\",\r\n            \"testDomain\": {\r\n                \"class\": \"GSLB_Domain\",\r\n                \"domainName\": \"{{APP_NAME}}\",\r\n                \"resourceRecordType\": \"A\",\r\n                \"poolLbMode\": \"ratio\",\r\n                \"pools\": [\r\n                              { \"use\": \"{{APP_NAME}}-pool\" }\r\n                ]\r\n            },\r\n            \"{{APP_NAME}}-pool\": {\r\n               \"class\": \"GSLB_Pool\",\r\n                \"enabled\": true,\r\n                \"lbModeAlternate\": \"ratio\",\r\n                \"lbModeFallback\": \"ratio\",\r\n                \"manualResumeEnabled\": false,\r\n                \"verifyMemberEnabled\": true,\r\n                \"members\": [\r\n                \t{\r\n                \t\"ratio\":10,\r\n                \t\"server\": {\r\n                \t\t\"bigip\": \"/Common/bigip1.f5lab.local\"\r\n                \t\t},\r\n                \t\t\"virtualServer\":\"/{{PARTITION_NAME}}/{{PATH_NAME}}/{{APP_NAME}}\"\r\n                \t}\r\n                ],\r\n                \"resourceRecordType\": \"A\"\r\n            }\r\n        }\r\n    }\r\n \r\n}"
								},
								"url": {
									"raw": "https://10.1.1.11/mgmt/shared/appsvcs/declare",
									"protocol": "https",
									"host": [
										"10",
										"1",
										"1",
										"11"
									],
									"path": [
										"mgmt",
										"shared",
										"appsvcs",
										"declare"
									]
								}
							},
							"response": []
						},
						{
							"name": "bigip5-Create-Add bigip1 pua.acme.com VS to Server",
							"event": [
								{
									"listen": "test",
									"script": {
										"id": "3ad638ed-3d2d-4f74-bf60-7d6180a2c194",
										"exec": [
											"if (responseCode.code === 200) {",
											"pm.collectionVariables.set('PRIOR_RESPONSE', 'OK' );",
											"pm.test(\"Virtual Server added to Server\", function () {",
											"    pm.response.to.have.status(200);",
											"});",
											"} else ",
											"pm.test(\"Virtual Server Exists\", function () {",
											"    pm.response.to.have.status(409);",
											"});"
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "prerequest",
									"script": {
										"id": "1296da8f-c337-4210-8507-3196d709ffef",
										"exec": [
											"pm.collectionVariables.set(\"APP_NAME\", \"pua.acme.com\");",
											"pm.collectionVariables.set(\"PATH_NAME\", \"Application\");",
											"pm.collectionVariables.set(\"PARTITION_NAME\", \"Common\");",
											"",
											"var PRIOR_RESPONSE = pm.collectionVariables.get(\"PRIOR_RESPONSE\");",
											"",
											"if (PRIOR_RESPONSE === 'OK') {",
											"",
											"}"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json",
										"type": "text"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\r\n\"name\": \"/{{PARTITION_NAME}}/{{PATH_NAME}}/{{APP_NAME}}\",\r\n\"destination\": \"10.1.10.102:443\"\r\n}"
								},
								"url": {
									"raw": "https://10.1.1.11/mgmt/tm/gtm/server/~Common~bigip1.f5lab.local/virtual-servers/",
									"protocol": "https",
									"host": [
										"10",
										"1",
										"1",
										"11"
									],
									"path": [
										"mgmt",
										"tm",
										"gtm",
										"server",
										"~Common~bigip1.f5lab.local",
										"virtual-servers",
										""
									]
								}
							},
							"response": []
						},
						{
							"name": "bigip5-Create-WideIP pua.acme.com using AS3",
							"event": [
								{
									"listen": "test",
									"script": {
										"id": "b3407355-4ecd-47a2-9c64-6dbd5ac6c6c4",
										"exec": [
											"if (responseCode.code === 200) {",
											"pm.collectionVariables.set('PRIOR_RESPONSE', 'OK' );",
											"}",
											"",
											"pm.test(\"Wide IP Created\", function () {",
											"    pm.response.to.have.status(200);",
											"});",
											"",
											"postman.setNextRequest(null);"
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "prerequest",
									"script": {
										"id": "2fc86471-4caa-4941-86af-055b9afd3bba",
										"exec": [
											"setTimeout(function(){}, 2000);",
											"",
											"var PRIOR_RESPONSE = pm.collectionVariables.get(\"PRIOR_RESPONSE\");",
											"",
											"if (PRIOR_RESPONSE === 'OK') {",
											"",
											"}"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\r\n \"class\": \"ADC\",\r\n    \"schemaVersion\": \"3.6.0\",\r\n    \"id\": \"GSLB_Sample\",\r\n    \"{{APP_NAME}}\": {\r\n        \"class\": \"Tenant\",\r\n        \"Application\": {\r\n            \"class\": \"Application\",\r\n            \"template\": \"generic\",\r\n            \"testDomain\": {\r\n                \"class\": \"GSLB_Domain\",\r\n                \"domainName\": \"{{APP_NAME}}\",\r\n                \"resourceRecordType\": \"A\",\r\n                \"poolLbMode\": \"ratio\",\r\n                \"pools\": [\r\n                              { \"use\": \"{{APP_NAME}}-pool\" }\r\n                ]\r\n            },\r\n            \"{{APP_NAME}}-pool\": {\r\n               \"class\": \"GSLB_Pool\",\r\n                \"enabled\": true,\r\n                \"lbModeAlternate\": \"ratio\",\r\n                \"lbModeFallback\": \"ratio\",\r\n                \"manualResumeEnabled\": false,\r\n                \"verifyMemberEnabled\": true,\r\n                \"members\": [\r\n                \t{\r\n                \t\"ratio\":10,\r\n                \t\"server\": {\r\n                \t\t\"bigip\": \"/Common/bigip1.f5lab.local\"\r\n                \t\t},\r\n                \t\t\"virtualServer\":\"/{{PARTITION_NAME}}/{{PATH_NAME}}/{{APP_NAME}}\"\r\n                \t}\r\n                ],\r\n                \"resourceRecordType\": \"A\"\r\n            }\r\n        }\r\n    }\r\n \r\n}"
								},
								"url": {
									"raw": "https://10.1.1.11/mgmt/shared/appsvcs/declare",
									"protocol": "https",
									"host": [
										"10",
										"1",
										"1",
										"11"
									],
									"path": [
										"mgmt",
										"shared",
										"appsvcs",
										"declare"
									]
								}
							},
							"response": []
						}
					],
					"protocolProfileBehavior": {},
					"_postman_isSubFolder": true
				},
				{
					"name": "Lab",
					"item": [],
					"protocolProfileBehavior": {},
					"_postman_isSubFolder": true
				},
				{
					"name": "Delete Lab Components",
					"item": [
						{
							"name": "bigip5-Delete-Test AS3 is running",
							"event": [
								{
									"listen": "test",
									"script": {
										"id": "c206c5c3-202c-4bb4-bcb2-19069e4ea058",
										"exec": [
											"if (responseCode.code === 200) {",
											"pm.collectionVariables.set('PRIOR_RESPONSE', 'OK' );",
											"",
											"}",
											"",
											"",
											"pm.test(\"AS3 is Running\", function () {",
											"    pm.response.to.have.status(200);",
											"});",
											"",
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "prerequest",
									"script": {
										"id": "2fc441d2-8846-4d4a-99cf-6dbd2959ff50",
										"exec": [
											"var STAGE = pm.environment.get(\"stage\");",
											"",
											"if (STAGE === \"delete\") {",
											"",
											"pm.collectionVariables.set(\"DNS_RESOLVER_NAME\", \"internal-dns-resolver\");",
											"pm.collectionVariables.set(\"SERVER_SSL_NAME\", \"apiadmin-serverssl\");",
											"pm.collectionVariables.set(\"IRULE_NAME\", \"Cert_SSO\");",
											"} else",
											"postman.setNextRequest(null);",
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin",
											"type": "string"
										}
									]
								},
								"method": "GET",
								"header": [],
								"url": {
									"raw": "https://10.1.1.11/mgmt/shared/appsvcs/info",
									"protocol": "https",
									"host": [
										"10",
										"1",
										"1",
										"11"
									],
									"path": [
										"mgmt",
										"shared",
										"appsvcs",
										"info"
									]
								}
							},
							"response": []
						},
						{
							"name": "bigip5-Delete-WideIP mtls.acme.com",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "da968693-0f01-4379-a3c4-2e2e17006078",
										"exec": [
											"pm.collectionVariables.set(\"APP_NAME\", \"mtls.acme.com\");",
											"pm.collectionVariables.set(\"PATH_NAME\", \"Application\");",
											"pm.collectionVariables.set(\"PARTITION_NAME\", \"Common\");",
											"",
											"var PRIOR_RESPONSE = pm.collectionVariables.get(\"PRIOR_RESPONSE\");",
											"",
											"if (PRIOR_RESPONSE === 'OK') {",
											"",
											"}"
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"id": "21b027c0-1b99-4962-9ad6-a76e323c85df",
										"exec": [
											"",
											"if (responseCode.code === 200) {",
											"pm.collectionVariables.set('PRIOR_RESPONSE', 'OK' );",
											"pm.test(\"Wide IP deleted\", function () {",
											"    pm.response.to.have.status(200);",
											"});",
											"} else if (responseCode.code === 422) {",
											"pm.test(\"WideIP does not exist\", function () {",
											"    pm.expect(pm.response.text()).to.include(\"path does not exist\");",
											"});",
											"",
											"}"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin",
											"type": "string"
										}
									]
								},
								"method": "PATCH",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "[\n{\n\t\"op\":\"remove\",\n\t\"path\":\"{{APP_NAME}}/Application\"\n \n}\n]"
								},
								"url": {
									"raw": "https://10.1.1.11/mgmt/shared/appsvcs/declare",
									"protocol": "https",
									"host": [
										"10",
										"1",
										"1",
										"11"
									],
									"path": [
										"mgmt",
										"shared",
										"appsvcs",
										"declare"
									]
								}
							},
							"response": []
						},
						{
							"name": "bigip5-Delete-bigip1 Server VS mtls.acme.com",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "ba39bc50-c3d8-497b-9e2d-09b111e5a352",
										"exec": [
											"setTimeout(function(){}, 2000);",
											"",
											"var PRIOR_RESPONSE = pm.collectionVariables.get(\"PRIOR_RESPONSE\");",
											"",
											"if (PRIOR_RESPONSE === 'OK') {",
											"",
											"}"
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"id": "f9680725-365a-4670-bed8-05b500785ca3",
										"exec": [
											"if (responseCode.code === 200) {",
											"pm.collectionVariables.set('PRIOR_RESPONSE', 'OK' );",
											"pm.test(\"VS deleted from server\", function () {",
											"    pm.response.to.have.status(200);",
											"});",
											"} else ",
											"pm.test(\"VS does not exist\", function () {",
											"    pm.response.to.have.status(404);",
											"});",
											"",
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin",
											"type": "string"
										}
									]
								},
								"method": "DELETE",
								"header": [
									{
										"key": "Content-Type",
										"type": "text",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": ""
								},
								"url": {
									"raw": "https://10.1.1.11/mgmt/tm/gtm/server/~Common~bigip1.f5lab.local/virtual-servers/~{{PARTITION_NAME}}~{{PATH_NAME}}~{{APP_NAME}}",
									"protocol": "https",
									"host": [
										"10",
										"1",
										"1",
										"11"
									],
									"path": [
										"mgmt",
										"tm",
										"gtm",
										"server",
										"~Common~bigip1.f5lab.local",
										"virtual-servers",
										"~{{PARTITION_NAME}}~{{PATH_NAME}}~{{APP_NAME}}"
									]
								}
							},
							"response": []
						},
						{
							"name": "bigip5-Delete-WideIP pua.acme.com",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "e3753451-270c-4e0a-8a1c-3a55a0bf69dd",
										"exec": [
											"pm.collectionVariables.set(\"APP_NAME\", \"pua.acme.com\");",
											"pm.collectionVariables.set(\"PATH_NAME\", \"Application\");",
											"pm.collectionVariables.set(\"PARTITION_NAME\", \"Common\");",
											"",
											"var PRIOR_RESPONSE = pm.collectionVariables.get(\"PRIOR_RESPONSE\");",
											"",
											"if (PRIOR_RESPONSE === 'OK') {",
											"",
											"}"
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"id": "faf17534-a0a8-4150-831b-3813b0ab0437",
										"exec": [
											"",
											"if (responseCode.code === 200) {",
											"pm.collectionVariables.set('PRIOR_RESPONSE', 'OK' );",
											"pm.test(\"Wide IP deleted\", function () {",
											"    pm.response.to.have.status(200);",
											"});",
											"} else if (responseCode.code === 422) {",
											"pm.test(\"WideIP does not exist\", function () {",
											"    pm.expect(pm.response.text()).to.include(\"path does not exist\");",
											"});",
											"",
											"}"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin",
											"type": "string"
										}
									]
								},
								"method": "PATCH",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "[\n{\n\t\"op\":\"remove\",\n\t\"path\":\"{{APP_NAME}}/Application\"\n \n}\n]"
								},
								"url": {
									"raw": "https://10.1.1.11/mgmt/shared/appsvcs/declare",
									"protocol": "https",
									"host": [
										"10",
										"1",
										"1",
										"11"
									],
									"path": [
										"mgmt",
										"shared",
										"appsvcs",
										"declare"
									]
								}
							},
							"response": []
						},
						{
							"name": "bigip5-Delete-bigip1 Server VS pua.acme.com",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "3b0a7b3f-b851-44ca-b6b9-5afc9ef5a58e",
										"exec": [
											"",
											"setTimeout(function(){}, 2000);",
											"var PRIOR_RESPONSE = pm.collectionVariables.get(\"PRIOR_RESPONSE\");",
											"",
											"if (PRIOR_RESPONSE === 'OK') {",
											"",
											"}"
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"id": "0b5603cd-ebab-4959-a4a9-2284c602e3c4",
										"exec": [
											"if (responseCode.code === 200) {",
											"pm.collectionVariables.set('PRIOR_RESPONSE', 'OK' );",
											"pm.test(\"VS deleted from server\", function () {",
											"    pm.response.to.have.status(200);",
											"});",
											"} else ",
											"pm.test(\"VS does not exist\", function () {",
											"    pm.response.to.have.status(404);",
											"});",
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin",
											"type": "string"
										}
									]
								},
								"method": "DELETE",
								"header": [
									{
										"key": "Content-Type",
										"type": "text",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": ""
								},
								"url": {
									"raw": "https://10.1.1.11/mgmt/tm/gtm/server/~Common~bigip1.f5lab.local/virtual-servers/~{{PARTITION_NAME}}~{{PATH_NAME}}~{{APP_NAME}}",
									"protocol": "https",
									"host": [
										"10",
										"1",
										"1",
										"11"
									],
									"path": [
										"mgmt",
										"tm",
										"gtm",
										"server",
										"~Common~bigip1.f5lab.local",
										"virtual-servers",
										"~{{PARTITION_NAME}}~{{PATH_NAME}}~{{APP_NAME}}"
									]
								}
							},
							"response": []
						},
						{
							"name": "bigip1-Delete-DNS Resolver",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "d315327e-7f86-47de-80e6-f8ca77c97121",
										"exec": [
											"",
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"id": "a891cd6d-4ffa-407b-986f-23e1fe39b2e8",
										"exec": [
											"if (responseCode.code === 200) {",
											"pm.collectionVariables.set('PRIOR_RESPONSE', 'OK' );",
											"pm.test(\"DNS Resolver deleted\", function () {",
											"    pm.response.to.have.status(200);",
											"});",
											"} else ",
											"pm.test(\"DNS Resolver does not exist\", function () {",
											"    pm.response.to.have.status(404);",
											"});",
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin",
											"type": "string"
										}
									]
								},
								"method": "DELETE",
								"header": [
									{
										"key": "Content-Type",
										"type": "text",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\r\n\"name\":\"internal-dns-resolver\", \r\n \"forwardZones\": [\r\n                {\r\n                    \"name\": \".\",\r\n                    \"nameservers\": [\r\n                        {\r\n                            \"name\": \"10.1.20.7:53\"\r\n                        }\r\n                    ]\r\n                }\r\n            ]\r\n}"
								},
								"url": {
									"raw": "https://10.1.1.4/mgmt/tm/net/dns-resolver/{{DNS_RESOLVER_NAME}}",
									"protocol": "https",
									"host": [
										"10",
										"1",
										"1",
										"4"
									],
									"path": [
										"mgmt",
										"tm",
										"net",
										"dns-resolver",
										"{{DNS_RESOLVER_NAME}}"
									]
								}
							},
							"response": []
						},
						{
							"name": "bigip1-Delete-irule",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "0ecfafb7-4aa9-4ea8-9af1-d4c69383cf1c",
										"exec": [
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"id": "09e22634-b322-4919-9bb7-23bb30eae936",
										"exec": [
											"if (responseCode.code === 200) {",
											"pm.collectionVariables.set('PRIOR_RESPONSE', 'OK' );",
											"pm.test(\"iRule deleted\", function () {",
											"    pm.response.to.have.status(200);",
											"});",
											"} else ",
											"pm.test(\"iRule not exist\", function () {",
											"    pm.response.to.have.status(404);",
											"});",
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin",
											"type": "string"
										}
									]
								},
								"method": "DELETE",
								"header": [
									{
										"key": "Content-Type",
										"type": "text",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\r\n\"name\":\"internal-dns-resolver\", \r\n \"forwardZones\": [\r\n                {\r\n                    \"name\": \".\",\r\n                    \"nameservers\": [\r\n                        {\r\n                            \"name\": \"10.1.20.7:53\"\r\n                        }\r\n                    ]\r\n                }\r\n            ]\r\n}"
								},
								"url": {
									"raw": "https://10.1.1.4/mgmt/tm/ltm/rule/{{IRULE_NAME}}",
									"protocol": "https",
									"host": [
										"10",
										"1",
										"1",
										"4"
									],
									"path": [
										"mgmt",
										"tm",
										"ltm",
										"rule",
										"{{IRULE_NAME}}"
									]
								}
							},
							"response": []
						},
						{
							"name": "bigip1-Delete-APM AAA LDAP",
							"event": [
								{
									"listen": "test",
									"script": {
										"id": "d3184caf-2cce-40c7-816b-a087f8570d36",
										"exec": [
											"if (responseCode.code === 200) {",
											"pm.collectionVariables.set('PRIOR_RESPONSE', 'OK' );",
											"pm.test(\"APM AAA LDAP Object deleted\", function () {",
											"    pm.response.to.have.status(200);",
											"});",
											"} else ",
											"pm.test(\"APM AAA LDAP Object not exist\", function () {",
											"    pm.response.to.have.status(404);",
											"});",
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin",
											"type": "string"
										}
									]
								},
								"method": "DELETE",
								"header": [],
								"url": {
									"raw": "https://10.1.1.4/mgmt/tm/apm/aaa/ldap/~Common~ldap-servers",
									"protocol": "https",
									"host": [
										"10",
										"1",
										"1",
										"4"
									],
									"path": [
										"mgmt",
										"tm",
										"apm",
										"aaa",
										"ldap",
										"~Common~ldap-servers"
									]
								}
							},
							"response": []
						},
						{
							"name": "bigip1-Delete-LDAP Server Pool",
							"event": [
								{
									"listen": "test",
									"script": {
										"id": "7c6cbeed-f8ef-42d4-b9e4-84561368961e",
										"exec": [
											"if (responseCode.code === 200) {",
											"pm.collectionVariables.set('PRIOR_RESPONSE', 'OK' );",
											"pm.test(\"Pool Deleted\", function () {",
											"    pm.response.to.have.status(200);",
											"});",
											"} else ",
											"pm.test(\"Pool Does Not Exist\", function () {",
											"    pm.response.to.have.status(404);",
											"});",
											"",
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin",
											"type": "string"
										}
									]
								},
								"method": "DELETE",
								"header": [
									{
										"key": "Content-Type",
										"type": "text",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "\n{\n\t\"name\":\"ldap-pool\",\n\t\"members\":[\n\t\t{\n\t\t\"name\":\"10.1.20.7:0\",\n\t\t\"address\":\"10.1.20.7\",\n\t\t\"monitor\": \"/Common/gateway_icmp\"\n\t\t\t\n\t\t}\n\t\t]\n}"
								},
								"url": {
									"raw": "https://10.1.1.4/mgmt/tm/ltm/pool/~Common~ldap-pool",
									"protocol": "https",
									"host": [
										"10",
										"1",
										"1",
										"4"
									],
									"path": [
										"mgmt",
										"tm",
										"ltm",
										"pool",
										"~Common~ldap-pool"
									]
								}
							},
							"response": []
						},
						{
							"name": "bigip1-Delete-APIadmin Serverside SSL Profile",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "eb30228a-e614-4f58-a95d-25c35738ac60",
										"exec": [
											"",
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"id": "674165d8-23f1-4df5-9703-4ffac71280d6",
										"exec": [
											"if (responseCode.code === 200) {",
											"pm.collectionVariables.set('PRIOR_RESPONSE', 'OK' );",
											"pm.test(\"Server-Side SSL Profile deleted\", function () {",
											"    pm.response.to.have.status(200);",
											"});",
											"} else ",
											"pm.test(\"Server-Side SSL Profile does not exist\", function () {",
											"    pm.response.to.have.status(404);",
											"});",
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin",
											"type": "string"
										}
									]
								},
								"method": "DELETE",
								"header": [
									{
										"key": "Content-Type",
										"type": "text",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\r\n\"name\":\"internal-dns-resolver\", \r\n \"forwardZones\": [\r\n                {\r\n                    \"name\": \".\",\r\n                    \"nameservers\": [\r\n                        {\r\n                            \"name\": \"10.1.20.7:53\"\r\n                        }\r\n                    ]\r\n                }\r\n            ]\r\n}"
								},
								"url": {
									"raw": "https://10.1.1.4/mgmt/tm/ltm/profile/server-ssl/{{SERVER_SSL_NAME}}",
									"protocol": "https",
									"host": [
										"10",
										"1",
										"1",
										"4"
									],
									"path": [
										"mgmt",
										"tm",
										"ltm",
										"profile",
										"server-ssl",
										"{{SERVER_SSL_NAME}}"
									]
								}
							},
							"response": []
						}
					],
					"protocolProfileBehavior": {},
					"_postman_isSubFolder": true
				}
			],
			"protocolProfileBehavior": {}
		}
	],
	"variable": [
		{
			"id": "ca8f6210-7a34-473c-b974-4785b3e91c7b",
			"key": "PRIOR_RESPONSE",
			"value": "",
			"type": "string"
		},
		{
			"id": "de7e99f2-1c28-4f9c-b716-f5ab16e0f93e",
			"key": "DNS_RESOLVER_NAME",
			"value": "",
			"type": "string"
		},
		{
			"id": "85bb6733-64a6-4157-935c-d0413babb490",
			"key": "SERVER_SSL_NAME",
			"value": "",
			"type": "string"
		},
		{
			"id": "cf5bad7b-1c2e-45a4-b7ca-43bc0a7a8c5c",
			"key": "APP_NAME",
			"value": "",
			"type": "string"
		},
		{
			"id": "3cd096de-9fd6-46df-8b98-594ee7051243",
			"key": "PARTITION_NAME",
			"value": "",
			"type": "string"
		},
		{
			"id": "9e7ff49f-b66e-4b5b-8a43-a846486ecdb2",
			"key": "PATH_NAME",
			"value": "",
			"type": "string"
		},
		{
			"id": "74dfd9de-9d31-4cc8-954a-46ca1cf6e125",
			"key": "IRULE_NAME",
			"value": "",
			"type": "string"
		}
	],
	"protocolProfileBehavior": {}
}